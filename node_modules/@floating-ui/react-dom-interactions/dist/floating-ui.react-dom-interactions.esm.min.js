import{useFloating as e,offset as n,detectOverflow as t,getOverflowAncestors as r}from"@floating-ui/react-dom";export*from"@floating-ui/react-dom";import*as o from"react";import{useLayoutEffect as u,useEffect as c,useRef as l}from"react";import{createPortal as i,flushSync as s}from"react-dom";import{hideOthers as a}from"aria-hidden";var f="undefined"!=typeof document?u:c;function d(){const e=new Map;return{emit(n,t){var r;null==(r=e.get(n))||r.forEach((e=>e(t)))},on(n,t){e.set(n,[...e.get(n)||[],t])},off(n,t){e.set(n,(e.get(n)||[]).filter((e=>e!==t)))}}}let v=!1,m=0;const p=()=>"floating-ui-"+m++;const g=o["useId".toString()],h=null!=g?g:function(){const[e,n]=o.useState((()=>v?p():void 0));return f((()=>{null==e&&n(p())}),[]),o.useEffect((()=>{v||(v=!0)}),[]),e},b=o.createContext(null),y=o.createContext(null),w=()=>{var e,n;return null!=(e=null==(n=o.useContext(b))?void 0:n.id)?e:null},E=()=>o.useContext(y),R=()=>{const e=h(),n=E(),t=w();return f((()=>{const r={id:e,parentId:t};return null==n||n.addNode(r),()=>{null==n||n.removeNode(r)}}),[n,e,t]),e},x=e=>{let{children:n,id:t}=e;const r=w();return o.createElement(b.Provider,{value:o.useMemo((()=>({id:t,parentId:r})),[t,r])},n)},T=e=>{let{children:n}=e;const t=o.useRef([]),r=o.useCallback((e=>{t.current=[...t.current,e]}),[]),u=o.useCallback((e=>{t.current=t.current.filter((n=>n!==e))}),[]),c=o.useState((()=>d()))[0];return o.createElement(y.Provider,{value:o.useMemo((()=>({nodesRef:t,addNode:r,removeNode:u,events:c})),[t,r,u,c])},n)};function L(e){var n;return null!=(n=null==e?void 0:e.ownerDocument)?n:document}function I(e){var n;return null!=(n=L(e).defaultView)?n:window}function k(e){return!!e&&e instanceof I(e).Element}function C(e){return!!e&&e instanceof I(e).HTMLElement}function A(n){let{open:t=!1,onOpenChange:r=(()=>{}),whileElementsMounted:u,placement:c,middleware:l,strategy:i,nodeId:s}=void 0===n?{}:n;const a=E(),v=o.useRef(null),m=o.useRef({}),p=o.useState((()=>d()))[0],g=e({placement:c,middleware:l,strategy:i,whileElementsMounted:u}),h=o.useMemo((()=>({...g.refs,domReference:v})),[g.refs]),b=o.useMemo((()=>({...g,refs:h,dataRef:m,nodeId:s,events:p,open:t,onOpenChange:r})),[g,s,p,t,r,h]);f((()=>{const e=null==a?void 0:a.nodesRef.current.find((e=>e.id===s));e&&(e.context=b)}));const{reference:y}=g,w=o.useCallback((e=>{(k(e)||null===e)&&(b.refs.domReference.current=e),y(e)}),[y,b.refs]);return o.useMemo((()=>({...g,context:b,refs:h,reference:w})),[g,h,b,w])}function M(e,n,t){const r=new Map;return{..."floating"===t&&{tabIndex:-1},...e,...n.map((e=>e?e[t]:null)).concat(e).reduce(((e,n)=>n?(Object.entries(n).forEach((n=>{let[t,o]=n;if(0===t.indexOf("on")){var u;if(r.has(t)||r.set(t,[]),"function"==typeof o)null==(u=r.get(t))||u.push(o);e[t]=function(){for(var e,n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];null==(e=r.get(t))||e.forEach((e=>e(...o)))}}else e[t]=o})),e):e),{})}}const O=function(e){return void 0===e&&(e=[]),{getReferenceProps:n=>M(n,e,"reference"),getFloatingProps:n=>M(n,e,"floating"),getItemProps:n=>M(n,e,"item")}};function D(e,n){var t;let r=null!=(t=e.filter((e=>{var t;return e.parentId===n&&(null==(t=e.context)?void 0:t.open)})))?t:[],o=r;for(;o.length;){var u;o=null!=(u=e.filter((e=>{var n;return null==(n=o)?void 0:n.some((n=>{var t;return e.parentId===n.id&&(null==(t=e.context)?void 0:t.open)}))})))?u:[],r=r.concat(o)}return r}function P(e){let n,{restMs:t=0,buffer:r=.5,debug:o=null}=void 0===e?{}:e,u=!1;return e=>{let{x:o,y:c,placement:l,refs:i,onClose:s,nodeId:a,tree:f,leave:d=!1}=e;return function(e){var v,m;function p(){clearTimeout(n),s()}if(clearTimeout(n),e.pointerType&&"mouse"!==e.pointerType)return;const{clientX:g,clientY:h}=e,b="composedPath"in e?e.composedPath()[0]:e.target;if("pointermove"===e.type&&null!=(v=i.domReference.current)&&v.contains(b))return;if(f&&D(f.nodesRef.current,a).some((e=>{let{context:n}=e;return null==n?void 0:n.open})))return;if(null!=(m=i.floating.current)&&m.contains(b)&&!d)return void(u=!0);if(!i.domReference.current||!i.floating.current||null==l||null==o||null==c)return;const y=i.domReference.current.getBoundingClientRect(),w=i.floating.current.getBoundingClientRect(),E=l.split("-")[0],R=o>w.right-w.width/2,x=c>w.bottom-w.height/2;if("top"===E&&c>=y.bottom-1||"bottom"===E&&c<=y.top+1||"left"===E&&o>=y.right-1||"right"===E&&o<=y.left+1)return p();switch(E){case"top":if(g>=w.left&&g<=w.right&&h>=w.top&&h<=y.top+1)return;break;case"bottom":if(g>=w.left&&g<=w.right&&h>=y.bottom-1&&h<=w.bottom)return;break;case"left":if(g>=w.left&&g<=y.left+1&&h>=w.top&&h<=w.bottom)return;break;case"right":if(g>=y.right-1&&g<=w.right&&h>=w.top&&h<=w.bottom)return}if(u)return p();const T=function(e){let[n,t]=e;const o=w.width>y.width,u=w.height>y.height;switch(E){case"top":return[[o?n+r/2:R?n+4*r:n-4*r,t+r+1],[o?n-r/2:R?n+4*r:n-4*r,t+r+1],...[[w.left,R||o?w.bottom-r:w.top],[w.right,R?o?w.bottom-r:w.top:w.bottom-r]]];case"bottom":return[[o?n+r/2:R?n+4*r:n-4*r,t-r],[o?n-r/2:R?n+4*r:n-4*r,t-r],...[[w.left,R||o?w.top+r:w.bottom],[w.right,R?o?w.top+r:w.bottom:w.top+r]]];case"left":{const e=[n+r+1,u?t+r/2:x?t+4*r:t-4*r],o=[n+r+1,u?t-r/2:x?t+4*r:t-4*r];return[...[[x||u?w.right-r:w.left,w.top],[x?u?w.right-r:w.left:w.right-r,w.bottom]],e,o]}case"right":return[[n-r,u?t+r/2:x?t+4*r:t-4*r],[n-r,u?t-r/2:x?t+4*r:t-4*r],...[[x||u?w.left+r:w.right,w.top],[x?u?w.left+r:w.right:w.left+r,w.bottom]]]}}([o,c]);!function(e,n){const[t,r]=e;let o=!1;const u=n.length;for(let e=0,c=u-1;e<u;c=e++){const[u,l]=n[e]||[0,0],[i,s]=n[c]||[0,0];l>=r!=s>=r&&t<=(i-u)*(r-l)/(s-l)+u&&(o=!o)}return o}([g,h],T)?p():t&&(n=setTimeout(s,t))}}}const S="floating-ui-root",F=function(e){let{id:n=S,enabled:t=!0}=void 0===e?{}:e;const[r,u]=o.useState(null);return f((()=>{if(!t)return;const e=document.getElementById(n);if(e)u(e);else{const e=document.createElement("div");e.id=n,u(e),document.body.contains(e)||document.body.appendChild(e)}}),[n,t]),r},H=e=>{let{children:n,id:t=S,root:r=null}=e;const o=F({id:t,enabled:!r});return r?i(n,r):o?i(n,o):null};function K(){return K=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},K.apply(this,arguments)}const j="data-floating-ui-scroll-lock",N=o.forwardRef((function(e,n){let{lockScroll:t=!1,...r}=e;return f((()=>{var e,n,r,o;if(!t)return;if(document.body.hasAttribute(j))return;document.body.setAttribute(j,"");const u=Math.round(document.documentElement.getBoundingClientRect().left)+document.documentElement.scrollLeft?"paddingLeft":"paddingRight",c=window.innerWidth-document.documentElement.clientWidth;if(!/iP(hone|ad|od)|iOS/.test(function(){const e=navigator.userAgentData;return null!=e&&e.platform?e.platform:navigator.platform}()))return Object.assign(document.body.style,{overflow:"hidden",[u]:c+"px"}),()=>{document.body.removeAttribute(j),Object.assign(document.body.style,{overflow:"",[u]:""})};const l=null!=(e=null==(n=window.visualViewport)?void 0:n.offsetLeft)?e:0,i=null!=(r=null==(o=window.visualViewport)?void 0:o.offsetTop)?r:0,s=window.pageXOffset,a=window.pageYOffset;return Object.assign(document.body.style,{position:"fixed",overflow:"hidden",top:-(a-Math.floor(i))+"px",left:-(s-Math.floor(l))+"px",right:"0",[u]:c+"px"}),()=>{Object.assign(document.body.style,{position:"",overflow:"",top:"",left:"",right:"",[u]:""}),document.body.removeAttribute(j),window.scrollTo(s,a)}}),[t]),o.createElement("div",K({ref:n},r,{style:{position:"fixed",overflow:"auto",top:0,right:0,bottom:0,left:0,...r.style}}))}));function V(e){let n=e.activeElement;for(;null!=(null==(t=n)||null==(r=t.shadowRoot)?void 0:r.activeElement);){var t,r;n=n.shadowRoot.activeElement}return n}const B="input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])";function q(e){return C(e)&&e.matches(B)}function U(e){e.preventDefault(),e.stopPropagation()}function Y(e){const n=l(e);return f((()=>{n.current=e})),n}function X(e,n){void 0===n&&(n=!1),requestAnimationFrame((()=>{null==e||e.focus({preventScroll:n})}))}const W=o.forwardRef((function(e,n){return o.createElement("span",K({},e,{ref:n,tabIndex:0,style:{position:"fixed",opacity:"0",pointerEvents:"none",outline:"0"}}))}));function z(e){var n;let{context:{refs:t,nodeId:r,onOpenChange:u,dataRef:c,events:l},children:i,order:s=["content"],endGuard:f=!0,preventTabbing:d=!1,initialFocus:v=0,returnFocus:m=!0,modal:p=!0}=e;const g=Y(s),h=Y(u),b=E(),y=null==(null==b||null==(n=b.nodesRef.current.find((e=>e.id===r)))?void 0:n.parentId),w=o.useCallback((()=>g.current.map((e=>{return"reference"===e?t.domReference.current:t.floating.current&&"floating"===e?t.floating.current:"content"===e?Array.from(null!=(n=null==(r=t.floating.current)?void 0:r.querySelectorAll("select:not([disabled]),a[href],button:not([disabled]),[tabindex],iframe,object,embed,area[href],audio[controls],video[controls],input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])"))?n:[]):null;var n,r})).flat().filter((e=>{if(e===t.floating.current||e===t.domReference.current)return!0;if(C(e)){var n;return"-"!==(null!=(n=e.getAttribute("tabindex"))?n:"0")[0].trim()}}))),[g,t]);o.useEffect((()=>{if(!p)return;const e=0===w().filter((e=>e!==t.floating.current&&e!==t.domReference.current)).length;function n(n){if("Tab"===n.key){(d||e)&&U(n);const r=w(),o="composedPath"in n?n.composedPath()[0]:n.target;"reference"===g.current[0]&&o===t.domReference.current&&(U(n),n.shiftKey?X(r[r.length-1]):X(r[1])),"floating"===g.current[1]&&o===t.floating.current&&n.shiftKey&&(U(n),X(r[0]))}}const r=L(t.floating.current);return r.addEventListener("keydown",n),()=>{r.removeEventListener("keydown",n)}}),[d,p,w,g,t]),o.useEffect((()=>{function e(e){var n,o;const u=e.relatedTarget,c=!(null!=(n=t.floating.current)&&n.contains(u)),l=k(t.domReference.current)&&!t.domReference.current.contains(u),i=b&&D(b.nodesRef.current,r).length>0,s=b&&e.currentTarget===t.domReference.current&&(null==(o=function(e,n){var t;let r=[],o=null==(t=e.find((e=>e.id===n)))?void 0:t.parentId;for(;o;){const n=e.find((e=>e.id===o));o=null==n?void 0:n.parentId,n&&(r=r.concat(n))}return r}(b.nodesRef.current,r))?void 0:o.some((e=>{var n,t;return null==(n=e.context)||null==(t=n.refs.floating.current)?void 0:t.contains(u)})));c&&l&&!i&&!s&&h.current(!1)}const n=t.floating.current,o=t.domReference.current;if(n&&C(o)){let t;return!p&&n.addEventListener("focusout",e),!p&&o.addEventListener("focusout",e),p&&(t=g.current.includes("reference")?a([o,n]):a(n)),()=>{!p&&n.removeEventListener("focusout",e),!p&&o.removeEventListener("focusout",e),null==t||t()}}}),[r,b,p,h,g,c,w,t]),o.useEffect((()=>{if(d&&!y)return;const e=t.floating.current,n=L(e);let r=m,o=!1,u=V(n);var c;if(u===n.body&&t.domReference.current&&(u=t.domReference.current),!d)if("number"==typeof v)X(null!=(c=w()[v])?c:e);else if(C(null==v?void 0:v.current)){var i;X(null!=(i=v.current)?i:e)}function s(e){void 0===e&&(e=!1),"object"==typeof e?(r=!0,o=e.preventScroll):r=e}return l.on("dismiss",s),()=>{l.off("dismiss",s),r&&C(u)&&X(u,o)}}),[d,w,v,m,t,l,y]);const R=()=>{var e;return"combobox"===(null==(e=t.domReference.current)?void 0:e.getAttribute("role"))&&q(t.domReference.current)};return o.createElement(o.Fragment,null,p&&o.createElement(W,{onFocus:e=>{if(R())return;U(e);const n=w();"reference"===s[0]?X(n[0]):X(n[n.length-1])}}),o.cloneElement(i,s.includes("floating")?{tabIndex:0}:{}),p&&f&&o.createElement(W,{onFocus:e=>{R()||(U(e),X(w()[0]))}}))}function G(e){const n=l();return f((()=>{n.current=e}),[e]),n.current}function J(e,n,t){return t&&"mouse"!==t?0:"number"==typeof e?e:null==e?void 0:e[n]}const Q=function(e,n){let{enabled:t=!0,delay:r=0,handleClose:u=null,mouseOnly:c=!1,restMs:l=0}=void 0===n?{}:n;const{open:i,onOpenChange:s,dataRef:a,events:d,refs:v}=e,m=E(),p=w(),g=Y(s),h=Y(u),b=G(i),y=o.useRef(),R=o.useRef(),x=o.useRef(),T=o.useRef(),I=o.useRef(!0),C=o.useRef(!1),A=o.useCallback((()=>{var e;const n=null==(e=a.current.openEvent)?void 0:e.type;return(null==n?void 0:n.includes("mouse"))&&"mousedown"!==n}),[a]);o.useEffect((()=>{if(t)return d.on("dismiss",e),()=>{d.off("dismiss",e)};function e(){clearTimeout(R.current),clearTimeout(T.current),I.current=!0}}),[t,d,v]),o.useEffect((()=>{if(!t||!h.current)return;function e(){A()&&g.current(!1)}const n=L(v.floating.current).documentElement;return n.addEventListener("mouseleave",e),()=>{n.removeEventListener("mouseleave",e)}}),[v,g,t,h,a,A]);const M=o.useCallback((function(e){void 0===e&&(e=!0);const n=J(r,"close",y.current);n&&!x.current?(clearTimeout(R.current),R.current=setTimeout((()=>g.current(!1)),n)):e&&(clearTimeout(R.current),g.current(!1))}),[r,g]),O=o.useCallback((()=>{x.current&&(L(v.floating.current).removeEventListener("pointermove",x.current),x.current=void 0)}),[v]),D=o.useCallback((()=>{L(v.floating.current).body.style.pointerEvents="",C.current=!1}),[v]);if(o.useEffect((()=>{if(!t)return;function n(){return!!a.current.openEvent&&["click","mousedown"].includes(a.current.openEvent.type)}function o(e){if(clearTimeout(R.current),I.current=!1,i||c&&"mouse"!==y.current||l>0&&0===J(r,"open"))return;a.current.openEvent=e;const n=J(r,"open",y.current);n?R.current=setTimeout((()=>{g.current(!0)}),n):g.current(!0)}function u(t){if(n())return;const r=L(v.floating.current);if(clearTimeout(T.current),h.current)return clearTimeout(R.current),x.current&&r.removeEventListener("pointermove",x.current),x.current=h.current({...e,tree:m,x:t.clientX,y:t.clientY,onClose(){D(),O(),M()}}),void r.addEventListener("pointermove",x.current);M()}function s(t){n()||null==h.current||h.current({...e,tree:m,x:t.clientX,y:t.clientY,leave:!0,onClose(){D(),O(),M()}})(t)}const f=v.floating.current,d=v.domReference.current;return k(d)?(i&&d.addEventListener("mouseleave",s),null==f||f.addEventListener("mouseleave",s),d.addEventListener("mousemove",o,{once:!0}),d.addEventListener("mouseenter",o),d.addEventListener("mouseleave",u),()=>{i&&d.removeEventListener("mouseleave",s),null==f||f.removeEventListener("mouseleave",s),d.removeEventListener("mousemove",o),d.removeEventListener("mouseenter",o),d.removeEventListener("mouseleave",u)}):void 0}),[t,M,e,r,h,a,c,g,i,m,l,O,D,v]),f((()=>{if(t&&i&&h.current&&A()){L(v.floating.current).body.style.pointerEvents="none",C.current=!0;const t=v.domReference.current,r=v.floating.current;if(k(t)&&r){var e,n;const o=null==m||null==(e=m.nodesRef.current.find((e=>e.id===p)))||null==(n=e.context)?void 0:n.refs.floating.current;return o&&(o.style.pointerEvents=""),t.style.pointerEvents="auto",r.style.pointerEvents="auto",()=>{t.style.pointerEvents="",r.style.pointerEvents=""}}}}),[t,i,p,v,m,h,a,A]),f((()=>{b&&!i&&(y.current=void 0,O(),D())})),o.useEffect((()=>()=>{O(),clearTimeout(R.current),clearTimeout(T.current),C.current&&D()}),[t,O,D]),!t)return{};function P(e){y.current=e.pointerType}return{reference:{onPointerDown:P,onPointerEnter:P,onMouseMove(){i||0===l||(clearTimeout(T.current),T.current=setTimeout((()=>{I.current||s(!0)}),l))}},floating:{onMouseEnter(){clearTimeout(R.current)},onMouseLeave(){M(!1)}}}},Z=o.createContext({delay:1e3,initialDelay:1e3,currentId:null,setCurrentId:()=>{},setState:()=>{}}),$=()=>o.useContext(Z),_=e=>{let{children:n,delay:t}=e;const[r,u]=o.useState({delay:t,initialDelay:t,currentId:null}),c=o.useCallback((e=>{u((n=>({...n,currentId:e})))}),[]);return o.createElement(Z.Provider,{value:o.useMemo((()=>({...r,setState:u,setCurrentId:c})),[r,u,c])},n)},ee=(e,n)=>{let{open:t,onOpenChange:r}=e,{id:u}=n;const{currentId:c,initialDelay:l,setState:i}=$(),s=Y(r);o.useEffect((()=>{c&&s.current&&(i((e=>({...e,delay:{open:1,close:J(l,"close")}}))),c!==u&&s.current(!1))}),[u,s,i,c,l]),o.useEffect((()=>{!t&&c===u&&s.current&&(s.current(!1),i((e=>({...e,delay:l,currentId:null}))))}),[t,i,c,u,s,l])};function ne(e,n){return{...e,rects:{...e.rects,floating:{...e.rects.floating,height:e.elements.floating[n]}}}}const te=e=>({name:"inner",options:e,async fn(r){const{listRef:o,overflowRef:u,onFallbackChange:c,offset:l=0,index:i=0,minItemsVisible:a=4,referenceOverflowThreshold:f=0,...d}=e,{rects:v,elements:{floating:m}}=r,p=o.current[i];if(!p)return{};const g={...r,...await n(-p.offsetTop-v.reference.height/2-p.offsetHeight/2-l).fn(r)},h=await t(ne(g,"scrollHeight"),d),b=await t(g,{...d,elementContext:"reference"}),y=Math.max(0,h.top),w=g.y+y,E=Math.max(0,m.scrollHeight-y-Math.max(0,h.bottom));return m.style.maxHeight=E+"px",m.scrollTop=y,c&&(m.offsetHeight<p.offsetHeight*Math.min(a,o.current.length-1)-1||b.top>=-f||b.bottom>=-f?s((()=>c(!0))):s((()=>c(!1)))),u&&(u.current=await t(ne({...g,y:w},"offsetHeight"),d)),{y:w}}}),re=(e,n)=>{let{open:t,refs:r}=e,{enabled:u=!0,overflowRef:c,onChange:l}=n;const i=Y(l),a=o.useRef(!1),f=o.useRef(null),d=o.useRef(null);return o.useEffect((()=>{if(!u)return;function e(e){if(e.ctrlKey||!n||null==c.current)return;const t=e.deltaY,r=c.current.top>=-.5,o=c.current.bottom>=-.5,u=n.scrollHeight-n.clientHeight,l=t<0?-1:1,a=t<0?"max":"min";n.scrollHeight<=n.clientHeight||(!r&&t>0||!o&&t<0?(e.preventDefault(),s((()=>{i.current((e=>e+Math[a](t,u*l)))}))):/firefox/i.test(function(){const e=navigator.userAgentData;return null!=e&&e.brands?e.brands.map((e=>{let{brand:n,version:t}=e;return n+"/"+t})).join(" "):navigator.userAgent}())&&(n.scrollTop+=t))}const n=r.floating.current;return t&&n?(n.addEventListener("wheel",e),requestAnimationFrame((()=>{f.current=n.scrollTop,null!=c.current&&(d.current={...c.current})})),()=>{f.current=null,d.current=null,n.removeEventListener("wheel",e)}):void 0}),[u,t,r,c,i]),u?{floating:{onKeyDown(){a.current=!0},onWheel(){a.current=!1},onPointerMove(){a.current=!1},onScroll(){const e=r.floating.current;if(c.current&&e&&a.current){if(null!==f.current){const n=e.scrollTop-f.current;(c.current.bottom<-.5&&n<-1||c.current.top<-.5&&n>1)&&s((()=>l((e=>e+n))))}requestAnimationFrame((()=>{f.current=e.scrollTop}))}}}}:{}},oe=function(e,n){let{open:t}=e,{enabled:r=!0,role:o="dialog"}=void 0===n?{}:n;const u=h(),c=h(),l={id:u,role:o};return r?"tooltip"===o?{reference:{"aria-describedby":t?u:void 0},floating:l}:{reference:{"aria-expanded":t?"true":"false","aria-haspopup":o,"aria-controls":t?u:void 0,..."listbox"===o&&{role:"combobox"},..."menu"===o&&{id:c}},floating:{...l,..."menu"===o&&{"aria-labelledby":c}}}:{}},ue=function(e,n){let{open:t,onOpenChange:r,dataRef:u,refs:c}=e,{enabled:l=!0,pointerDown:i=!1,toggle:s=!0,ignoreMouse:a=!1}=void 0===n?{}:n;const f=o.useRef();function d(){var e;return"BUTTON"===(null==(e=c.domReference.current)?void 0:e.tagName)}function v(){return q(c.domReference.current)}return l?{reference:{onPointerDown(e){f.current=e.pointerType},onMouseDown(e){0===e.button&&("mouse"===f.current&&a||i&&(t?!s||u.current.openEvent&&"mousedown"!==u.current.openEvent.type||r(!1):r(!0),u.current.openEvent=e.nativeEvent))},onClick(e){i&&f.current?f.current=void 0:"mouse"===f.current&&a||(t?!s||u.current.openEvent&&"click"!==u.current.openEvent.type||r(!1):r(!0),u.current.openEvent=e.nativeEvent)},onKeyDown(e){f.current=void 0,d()||(" "!==e.key||v()||e.preventDefault(),"Enter"===e.key&&(t?s&&r(!1):r(!0)))},onKeyUp(e){d()||v()||" "===e.key&&(t?s&&r(!1):r(!0))}}}:{}};function ce(e,n){if(null==n)return!1;if("composedPath"in e)return e.composedPath().includes(n);const t=e;return null!=t.target&&n.contains(t.target)}const le=function(e,n){let{open:t,onOpenChange:u,refs:c,events:l,nodeId:i}=e,{enabled:s=!0,escapeKey:a=!0,outsidePointerDown:f=!0,referencePointerDown:d=!1,ancestorScroll:v=!1,bubbles:m=!0}=void 0===n?{}:n;const p=E(),g=Y(u),h=null!=w();return o.useEffect((()=>{if(!t||!s)return;function e(e){if("Escape"===e.key){if(!m&&p&&D(p.nodesRef.current,i).length>0)return;l.emit("dismiss",{preventScroll:!1}),g.current(!1)}}function n(e){const n=p&&D(p.nodesRef.current,i).some((n=>{var t;return ce(e,null==(t=n.context)?void 0:t.refs.floating.current)}));ce(e,c.floating.current)||ce(e,c.domReference.current)||n||!m&&p&&D(p.nodesRef.current,i).length>0||(l.emit("dismiss",!!h&&{preventScroll:!0}),g.current(!1))}function o(){g.current(!1)}const u=L(c.floating.current);a&&u.addEventListener("keydown",e),f&&u.addEventListener("pointerdown",n);const d=(v?[...k(c.reference.current)?r(c.reference.current):[],...k(c.floating.current)?r(c.floating.current):[]]:[]).filter((e=>{var n;return e!==(null==(n=u.defaultView)?void 0:n.visualViewport)}));return d.forEach((e=>e.addEventListener("scroll",o,{passive:!0}))),()=>{a&&u.removeEventListener("keydown",e),f&&u.removeEventListener("pointerdown",n),d.forEach((e=>e.removeEventListener("scroll",o)))}}),[a,f,l,p,i,t,g,v,s,m,c,h]),s?{reference:{onPointerDown(){d&&(l.emit("dismiss"),u(!1))}}}:{}},ie=function(e,n){let{open:t,onOpenChange:r,dataRef:u,refs:c,events:l}=e,{enabled:i=!0,keyboardOnly:s=!0}=void 0===n?{}:n;const a=o.useRef(""),f=o.useRef(!1);return o.useEffect((()=>{var e;if(!i)return;const n=L(c.floating.current),r=null!=(e=n.defaultView)?e:window;function o(){a.current&&c.domReference.current===V(n)&&(f.current=!t)}function u(){setTimeout((()=>{f.current=!1,a.current=""}))}return r.addEventListener("focus",u),r.addEventListener("blur",o),()=>{r.removeEventListener("focus",u),r.removeEventListener("blur",o)}}),[c,t,i]),o.useEffect((()=>{if(i)return l.on("dismiss",e),()=>{l.off("dismiss",e)};function e(){f.current=!0}}),[l,i]),i?{reference:{onPointerDown(e){let{pointerType:n}=e;a.current=n,f.current=!(!n||!s)},onFocus(e){var n,t,o;f.current||"focus"===e.type&&"mousedown"===(null==(n=u.current.openEvent)?void 0:n.type)&&null!=(t=c.domReference.current)&&t.contains(null==(o=u.current.openEvent)?void 0:o.target)||(u.current.openEvent=e.nativeEvent,r(!0))},onBlur(e){var n,t;const o=e.relatedTarget;null!=(n=c.floating.current)&&n.contains(o)||null!=(t=c.domReference.current)&&t.contains(o)||(f.current=!1,r(!1))}}}:{}};function se(e,n){return n<0||n>=e.current.length}function ae(e,n){let{startingIndex:t=-1,decrement:r=!1,disabledIndices:o}=void 0===n?{}:n;const u=e.current;let c=t;do{var l,i;c+=r?-1:1}while(c>=0&&c<=u.length-1&&(o?o.includes(c):null==u[c]||(null==(l=u[c])?void 0:l.hasAttribute("disabled"))||"true"===(null==(i=u[c])?void 0:i.getAttribute("aria-disabled"))));return c}function fe(e,n,t){switch(e){case"vertical":return n;case"horizontal":return t;default:return n||t}}function de(e,n){return fe(n,"ArrowUp"===e||"ArrowDown"===e,"ArrowLeft"===e||"ArrowRight"===e)}function ve(e,n,t){return fe(n,"ArrowDown"===e,t?"ArrowLeft"===e:"ArrowRight"===e)||"Enter"===e||" "==e||""===e}function me(e,n){return ae(e,{disabledIndices:n})}function pe(e,n){return ae(e,{decrement:!0,startingIndex:e.current.length,disabledIndices:n})}const ge=function(e,n){let{open:t,onOpenChange:r,refs:u}=e,{listRef:c,activeIndex:l,onNavigate:i,enabled:s=!0,selectedIndex:a=null,allowEscape:d=!1,loop:v=!1,nested:m=!1,rtl:p=!1,virtual:g=!1,focusItemOnOpen:h="auto",focusItemOnHover:b=!0,openOnArrowKeyDown:y=!0,disabledIndices:R=(y?void 0:[]),orientation:x="vertical"}=void 0===n?{listRef:{current:[]},activeIndex:null,onNavigate:()=>{}}:n;const T=w(),I=E(),k=G(t),A=o.useRef(h),M=o.useRef(null!=a?a:-1),O=o.useRef(null),D=Y(G(i)),P=Y(i),S=Y(R),F=o.useRef(!1),H=o.useRef(-1),[K,j]=o.useState(),N=o.useCallback(((e,n)=>{H.current=requestAnimationFrame((()=>{var t,r;g?j(null==(t=e.current[n.current])?void 0:t.id):null==(r=e.current[n.current])||r.focus({preventScroll:!0})}))}),[g]);function B(e){if(F.current=!0,m&&function(e,n,t){return fe(n,t?"ArrowRight"===e:"ArrowLeft"===e,"ArrowUp"===e)}(e.key,x,p))return U(e),r(!1),void(C(u.domReference.current)&&u.domReference.current.focus());const n=M.current,o=me(c,R),l=pe(c,R);if("Home"===e.key&&(M.current=o,i(M.current)),"End"===e.key&&(M.current=l,i(M.current)),de(e.key,x)){if(U(e),t&&!g&&V(e.currentTarget.ownerDocument)===e.currentTarget)return M.current=ve(e.key,x,p)?o:l,void i(M.current);ve(e.key,x,p)?M.current=v?n>=l?d&&n!==c.current.length?-1:o:ae(c,{startingIndex:n,disabledIndices:R}):Math.min(l,ae(c,{startingIndex:n,disabledIndices:R})):M.current=v?n<=o?d&&-1!==n?c.current.length:l:ae(c,{startingIndex:n,decrement:!0,disabledIndices:R}):Math.max(o,ae(c,{startingIndex:n,decrement:!0,disabledIndices:R})),se(c,M.current)?i(null):i(M.current)}}return f((()=>{s&&(!k&&t&&A.current&&null!=a&&P.current(a),k&&!t&&(cancelAnimationFrame(H.current),M.current=-1,null==D.current||D.current(null)))}),[t,k,a,c,P,D,N,s]),f((()=>{if(s&&t)if(null==l){if(null!=a)return;k&&(M.current=-1,N(c,M)),!k&&A.current&&(null!=O.current||!0===A.current&&null==O.current)&&(M.current=null==O.current||ve(O.current,x,p)||m?me(c,S.current):pe(c,S.current),P.current(M.current),N(c,M))}else se(c,l)||(M.current=l,N(c,M))}),[t,k,l,a,m,c,P,N,s,d,x,p,g,S]),f((()=>{if(s&&!t&&k){var e,n;const t=null==I||null==(e=I.nodesRef.current.find((e=>e.id===T)))||null==(n=e.context)?void 0:n.refs.floating.current;t&&!t.contains(V(L(t)))&&t.focus({preventScroll:!0})}}),[s,t,k,I,T]),f((()=>{O.current=null})),s?{reference:{...g&&t&&null!=l&&{"aria-activedescendant":K},onKeyDown(e){if(F.current=!0,g&&t)return B(e);(0===e.key.indexOf("Arrow")||"Enter"===e.key||" "===e.key||""===e.key)&&(O.current=e.key),m?function(e,n,t){return fe(n,t?"ArrowLeft"===e:"ArrowRight"===e,"ArrowDown"===e)}(e.key,x,p)&&(U(e),t?(M.current=me(c,R),i(M.current)):r(!0)):de(e.key,x)&&(null!=a&&(M.current=a),U(e),!t&&y?r(!0):B(e),t&&i(M.current))}},floating:{"aria-orientation":"both"===x?void 0:x,...g&&null!=l&&{"aria-activedescendant":K},onKeyDown:B,onPointerMove(){F.current=!1}},item:{onFocus(e){let{currentTarget:n}=e;const t=c.current.indexOf(n);-1!==t&&i(t)},onClick:e=>{let{currentTarget:n}=e;return n.focus({preventScroll:!0})},...b&&{onMouseMove(e){let{currentTarget:n}=e;const t=n;if(t){const e=c.current.indexOf(t);-1!==e&&i(e)}},onPointerLeave(){var e;F.current||(M.current=-1,N(c,M),P.current(null),g||null==(e=u.floating.current)||e.focus({preventScroll:!0}))}}}}:{}},he=function(e,n){var t;let{open:r,dataRef:u}=e,{listRef:c,activeIndex:l,onMatch:i=(()=>{}),enabled:s=!0,findMatch:a=null,resetMs:d=1e3,ignoreKeys:v=[],selectedIndex:m=null}=void 0===n?{listRef:{current:[]},activeIndex:null}:n;const p=o.useRef(),g=o.useRef(""),h=o.useRef(null!=(t=null!=m?m:l)?t:-1),b=o.useRef(null);function y(e){if(!e.currentTarget.contains(V(L(e.currentTarget))))return;g.current.length>0&&" "!==g.current[0]&&(u.current.typing=!0," "===e.key&&U(e));const n=c.current;if(null==n||["Home","End","Escape","Enter","Tab","ArrowUp","ArrowDown","ArrowLeft","ArrowRight",...v].includes(e.key))return;n.every((e=>{var n,t;return!e||(null==(n=e[0])?void 0:n.toLocaleLowerCase())!==(null==(t=e[1])?void 0:t.toLocaleLowerCase())}))&&g.current===e.key&&(g.current="",h.current=b.current),g.current+=e.key,clearTimeout(p.current),p.current=setTimeout((()=>{g.current="",h.current=b.current,u.current.typing=!1}),d);const t=h.current,r=[...n.slice((null!=t?t:0)+1),...n.slice(0,(null!=t?t:0)+1)],o=a?a(r,g.current):r.find((e=>0===(null==e?void 0:e.toLocaleLowerCase().indexOf(g.current)))),l=o?n.indexOf(o):-1;-1!==l&&(i(l),b.current=l)}return f((()=>{r&&(clearTimeout(p.current),b.current=null,g.current="")}),[r]),f((()=>{var e;r&&""===g.current&&(h.current=null!=(e=null!=m?m:l)?e:-1)}),[r,m,l]),s?{reference:{onKeyDown:y},floating:{onKeyDown:y}}:{}};export{_ as FloatingDelayGroup,z as FloatingFocusManager,x as FloatingNode,N as FloatingOverlay,H as FloatingPortal,T as FloatingTree,te as inner,P as safePolygon,ue as useClick,ee as useDelayGroup,$ as useDelayGroupContext,le as useDismiss,A as useFloating,R as useFloatingNodeId,w as useFloatingParentNodeId,F as useFloatingPortalNode,E as useFloatingTree,ie as useFocus,Q as useHover,h as useId,re as useInnerOffset,O as useInteractions,ge as useListNavigation,oe as useRole,he as useTypeahead};
